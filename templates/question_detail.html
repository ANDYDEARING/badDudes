{% extends "base.html" %}
{% load static %}


{% block head %}
<script src="{% static 'compiled.js' %}" defer></script>

{% endblock %}


{% block content %}
<h1>{{ question.title }}</h1>
<p>{{ question.content |safe }}</p>
<h2>Answers:</h2>

{% if request.user.is_authenticated %}
    <a href="{% url 'new-answer' question.pk %}">Add an answer</a>

    <form action="" method="POST">
        {% csrf_token %}
        <br>
        <h5>Your Answer</h5>
        <textarea cols="40" rows="5" id="answerInput"></textarea>
        <br>
        <br>
        <button id="answerSubmit" data-questionpk="{{ question.pk }}">Submit</button>
    </form>


{% else %}
    <p>You need to <a class="washed-blue" href="{% url 'account_login' %}">login to your account</a> in order to submit an answer.</p>
{% endif %}

{% if question.answer_set.all %}
    <div id="displayAnswers">
        {% for answer in question.answer_set.all %}
        <hr>
        <p><strong>{{answer.content}}</strong> - {{answer.created_at}} by {{answer.author}} {% if question.correct_answer == answer %}<b>CORRECT ANSWER</b>{% endif %}</p></p>
    
        {% if question.author == request.user %}
            {% if question.correct_answer != answer %}
                <button class="makeCorrectLink" id="answer-{{ answer.pk }}" data-answerpk="{{ answer.pk }}" data-questionpk="{{ question.pk }}">Mark Answer as Correct</button>
            {% else %}
                <button class="makeCorrectLink" id="answer-{{ answer.pk }}" data-answerpk="{{ answer.pk }}" data-questionpk="{{ question.pk }}">CORRECT ANSWER (Click to remove)</button>
            {% endif %}   
        {% endif %}
        {% endfor %}
    </div>
{% else %}
    <p>There are no answers for this question.</p>
{% endif %}
</div>
{% endblock %}